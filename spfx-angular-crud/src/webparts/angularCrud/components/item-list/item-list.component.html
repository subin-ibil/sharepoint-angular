<div class="item-list-container">
  <div class="header">
    <h2>SharePoint List Items</h2>
    <button class="btn btn-primary" (click)="showCreateForm()" [disabled]="loading">
      + New Item
    </button>
  </div>

  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <div *ngIf="loading" class="loading">
    Loading...
  </div>

  <!-- Form Modal -->
  <div *ngIf="showForm" class="modal-overlay">
    <div class="modal-content">
      <h3>{{ editingItem ? 'Edit Item' : 'Create New Item' }}</h3>

      <div class="form-group">
        <label for="title">Title *</label>
        <input type="text" id="title" [(ngModel)]="formTitle" class="form-control" placeholder="Enter title">
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" [(ngModel)]="formDescription" class="form-control" rows="3"
          placeholder="Enter description"></textarea>
      </div>

      <div class="form-group">
        <label for="status">Status</label>
        <select id="status" [(ngModel)]="formStatus" class="form-control">
          <option value="Not Started">Not Started</option>
          <option value="In Progress">In Progress</option>
          <option value="Completed">Completed</option>
        </select>
      </div>

      <div class="form-group">
        <label for="dueDate">Due Date</label>
        <input type="date" id="dueDate" [(ngModel)]="formDueDate" class="form-control">
      </div>

      <div class="form-actions">
        <button class="btn btn-secondary" (click)="cancelForm()" [disabled]="loading">
          Cancel
        </button>
        <button class="btn btn-primary" (click)="saveItem()" [disabled]="loading">
          {{ editingItem ? 'Update' : 'Create' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Items Table -->
  <div *ngIf="!loading && items.length > 0" class="items-table">
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Description</th>
          <th>Status</th>
          <th>Due Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of items">
          <td>{{ item.fields.Title }}</td>
          <td>{{ item.fields.Description }}</td>
          <td>
            <span class="status-badge"
              [class]="'status-' + (item.fields.Status || 'Not Started').replace(' ', '-').toLowerCase()">
              {{ item.fields.Status || 'Not Started' }}
            </span>
          </td>
          <td>{{ item.fields.DueDate | date:'shortDate' }}</td>
          <td class="actions">
            <button class="btn-icon" (click)="editItem(item)" title="Edit">
              ‚úèÔ∏è
            </button>
            <button class="btn-icon btn-danger" (click)="deleteItem(item)" title="Delete">
              üóëÔ∏è
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && items.length === 0" class="no-items">
    No items found. Click "New Item" to create one.
  </div>
</div>